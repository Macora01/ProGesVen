[
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "session",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "csv",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "csv",
        "description": "csv",
        "detail": "csv",
        "documentation": {}
    },
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "timedelta",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "json",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "json",
        "description": "json",
        "detail": "json",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):\n        return jsonify({\n            'success': False,\n            'message': 'Formato de código inválido. Use código fábrica (3-8 caracteres) o código venta (BINNNNCC)'",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):\n        return jsonify({\n            'success': False,\n            'message': 'Formato de código inválido. Use código fábrica (3-8 caracteres) o código venta (BINNNNCC)'\n        })\n    productos = load_csv('productos.csv')\n    # Buscar producto",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n@app.route('/api/authorize', methods=['POST'])\ndef api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\nif __name__ == '__main__':\n    app.run(\n        debug=app_config.DEBUG, \n        host='0.0.0.0', \n        port=5000\n    )",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "Copia de app",
        "description": "Copia de app",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "Copia de app",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()\n    filename = f\"{lugar_limpio}_{today}.csv\"\n    filepath = os.path.join(SALES_DIR, filename)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "Copia de app6",
        "description": "Copia de app6",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "Copia de app6",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    # Filtrar bazares activos (fecha término >= fecha actual)\n    from datetime import datetime\n    hoy = datetime.now().date()\n    bazares_activos = []\n    for bazar in bazares:\n        try:\n            # Convertir fecha término de formato dd-mm-yy a objeto date",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos - Versión corregida\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos - Versión corregida\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas y devoluciones para un rango de fechas específico - Versión mejorada\"\"\"\n    total_sales = 0\n    total_returns = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    print(f\"Solicitud de reporte - Periodo: {period}, Start: {start_date}, End: {end_date}\")  # Debug\n    if start_date and end_date and period == 'custom':\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()\n    filename = f\"{lugar_limpio}_{today}.csv\"\n    filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_process_return",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_process_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_all_daily_transactions",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_all_daily_transactions(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_get_daily_transactions(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones)\"\"\"\n    try:\n        daily_data = get_all_daily_transactions(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_process_product_return",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_process_product_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def get_daily_transactions_with_returns(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones) para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "def api_get_daily_transactions_with_returns(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones) de un lugar específico\"\"\"\n    try:\n        daily_data = get_daily_transactions_with_returns(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app",
        "description": "app",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):\n        return jsonify({\n            'success': False,\n            'message': 'Formato de código inválido. Use código fábrica (3-8 caracteres) o código venta (BINNNNCC)'",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Validar formato del código\n    if not (validate_factory_code(code, app_config) or validate_sales_code(code, app_config)):\n        return jsonify({\n            'success': False,\n            'message': 'Formato de código inválido. Use código fábrica (3-8 caracteres) o código venta (BINNNNCC)'\n        })\n    productos = load_csv('productos.csv')\n    # Buscar producto",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\n# =============================================================================\n# FIN DEL ARCHIVO - Esto debe ir al final\n# =============================================================================\nif __name__ == '__main__':",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app1",
        "description": "app1",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app1",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\n# =============================================================================\n# FIN DEL ARCHIVO - Esto debe ir al final\n# =============================================================================\nif __name__ == '__main__':",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app2",
        "description": "app2",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app2",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\n# =============================================================================\n# FIN DEL ARCHIVO - Esto debe ir al final\n# =============================================================================\nif __name__ == '__main__':",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app3",
        "description": "app3",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app3",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, \"r\", encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, \"w\", newline=\"\", encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(\n                file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER\n            )\n            writer.writeheader()\n            writer.writerows(data)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def index():\n    return render_template(\"index.html\")\n@app.route(\"/search\")\ndef search():\n    return render_template(\"search.html\")\n@app.route(\"/api/search_product\", methods=[\"POST\"])\ndef api_search_product():\n    code = request.json.get(\"code\", \"\").strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith(\"BI\"):",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def search():\n    return render_template(\"search.html\")\n@app.route(\"/api/search_product\", methods=[\"POST\"])\ndef api_search_product():\n    code = request.json.get(\"code\", \"\").strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith(\"BI\"):\n        potential_code = \"BI6\" + code\n        # Primero buscar con el código completo\n        productos = load_csv(\"productos.csv\")",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_search_product():\n    code = request.json.get(\"code\", \"\").strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith(\"BI\"):\n        potential_code = \"BI6\" + code\n        # Primero buscar con el código completo\n        productos = load_csv(\"productos.csv\")\n        product = None\n        for p in productos:\n            if p.get(\"cod_venta\", \"\") == potential_code:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def sales():\n    telefonos = load_csv(\"telefonos.csv\")\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = (\n            t.get(\"lugar\") or t.get(\"Lugar\") or t.get(\"nombrepunto\") or t.get(\"Nombre\")\n        )",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get(\"lugar\")\n    codigo = request.json.get(\"codigo\", \"\").strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv(\n        \"productos.csv\",\n        fieldnames=[\"cod_fabrica\", \"cod_venta\", \"descripcion\", \"precio\"],\n    )\n    product = None\n    for p in productos:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv(\"bazares.csv\")\n    return render_template(\"events.html\", bazares=bazares)\n@app.route(\"/api/save_comment_events\", methods=[\"POST\"])\ndef api_save_comment_events():\n    comment = request.json.get(\"comment\", \"\").strip()\n    if comment:\n        fecha = datetime.now().strftime(\"%Y-%m-%d\")\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get(\"comment\", \"\").strip()\n    if comment:\n        fecha = datetime.now().strftime(\"%Y-%m-%d\")\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = [\"timestamp\", \"comment\"]\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv(\"puntosventa.csv\")\n    return render_template(\"points.html\", puntos=puntos)\n@app.route(\"/api/save_comment_points\", methods=[\"POST\"])\ndef api_save_comment_points():\n    comment = request.json.get(\"comment\", \"\").strip()\n    if comment:\n        fecha = datetime.now().strftime(\"%Y-%m-%d\")\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get(\"comment\", \"\").strip()\n    if comment:\n        fecha = datetime.now().strftime(\"%Y-%m-%d\")\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = [\"timestamp\", \"comment\"]\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv(\"tutoriales.csv\")\n    return render_template(\"tutorials.html\", tutoriales=tutoriales)\n@app.route(\"/info\")\ndef info():\n    # Verificar acceso\n    if not session.get(\"authorized\"):\n        return render_template(\"auth_required.html\")\n    telefonos = load_csv(\"telefonos.csv\")\n    return render_template(\"info.html\", telefonos=telefonos)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get(\"authorized\"):\n        return render_template(\"auth_required.html\")\n    telefonos = load_csv(\"telefonos.csv\")\n    return render_template(\"info.html\", telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route(\"/dashboard\")\ndef dashboard():\n    # Verificar acceso",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get(\"authorized\"):\n        return render_template(\"auth_required.html\")\n    return render_template(\"dashboard.html\")\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, \"r\", encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f\"_{today}.csv\", \"\")\n            total_amount = 0\n            total_sales = 0",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f\"_{today}.csv\", \"\")\n            try:\n                with open(filepath, \"r\", encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        \"avg_daily_sales\": 150000,  # Ejemplo - implementar cálculo real\n        \"best_selling_category\": \"Jeans\",\n        \"peak_hour\": \"16:00-17:00\",\n        \"conversion_rate\": \"68%\",",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_authorize():\n    password = request.json.get(\"password\", \"\")\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session[\"authorized\"] = True\n        return jsonify({\"success\": True})\n    else:\n        return jsonify({\"success\": False, \"message\": \"Contraseña incorrecta\"})\n@app.route(\"/under_construction\")\ndef under_construction():",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def under_construction():\n    return render_template(\"under_construction.html\")\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == \"today\":\n        start_date = today\n        end_date = today\n    elif period == \"week\":\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == \"month\":",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_reports():\n    if not session.get(\"authorized\"):\n        return jsonify({\"error\": \"No autorizado\"}), 403\n    period = request.args.get(\"period\", \"today\")\n    start_date = request.args.get(\"start_date\")\n    end_date = request.args.get(\"end_date\")\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get(\"authorized\"):\n        return jsonify({\"error\": \"No autorizado\"}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data(\"today\")\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    sales_data = []",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(\n        c for c in lugar if c.isalnum() or c in (\" \", \"-\", \"_\")\n    ).rstrip()",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\"success\": True, \"daily_data\": daily_data})\n    except Exception as e:\n        return jsonify(\n            {\"success\": False, \"message\": f\"Error obteniendo ventas del día: {str(e)}\"}\n        )\n# =============================================================================",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, \"r\", encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app4",
        "description": "app4",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, \"r\", encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app4",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()\n    filename = f\"{lugar_limpio}_{today}.csv\"\n    filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app5",
        "description": "app5",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app5",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas y devoluciones para un rango de fechas específico - Versión simplificada\"\"\"\n    total_sales = 0\n    total_returns = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()\n    filename = f\"{lugar_limpio}_{today}.csv\"\n    filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_process_return",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_process_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_all_daily_transactions",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_all_daily_transactions(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_get_daily_transactions(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones)\"\"\"\n    try:\n        daily_data = get_all_daily_transactions(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_process_product_return",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_process_product_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def get_daily_transactions_with_returns(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones) para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "def api_get_daily_transactions_with_returns(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones) de un lugar específico\"\"\"\n    try:\n        daily_data = get_daily_transactions_with_returns(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app_gr_ok",
        "description": "app_gr_ok",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app_gr_ok",
        "documentation": {}
    },
    {
        "label": "load_csv",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador\n            sample = file.read(1024)\n            file.seek(0)\n            # Determinar delimitador",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "save_csv",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def save_csv(filename, data, fieldnames):\n    \"\"\"Guardar datos en CSV\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    try:\n        with open(filepath, 'w', newline='', encoding=app_config.CSV_ENCODING) as file:\n            writer = csv.DictWriter(file, fieldnames=fieldnames, delimiter=app_config.CSV_DELIMITER)\n            writer.writeheader()\n            writer.writerows(data)\n        return True\n    except Exception as e:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def index():\n    return render_template('index.html')\n@app.route('/search')\ndef search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def search():\n    return render_template('search.html')\n@app.route('/api/search_product', methods=['POST'])\ndef api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_search_product",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_search_product():\n    code = request.json.get('code', '').strip().upper()\n    # Si el código tiene 5 caracteres y no empieza con BI, intentar agregar BI6\n    if len(code) == 5 and not code.startswith('BI'):\n        potential_code = 'BI6' + code\n        # Primero buscar con el código completo\n        productos = load_csv('productos.csv')\n        product = None\n        for p in productos:\n            if p.get('cod_venta', '') == potential_code:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "sales",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def sales():\n    telefonos = load_csv('telefonos.csv')\n    print(f\"Teléfonos cargados: {telefonos}\")  # Debug\n    # Extraer lugares únicos - manejar diferentes nombres de columna\n    lugares_set = set()\n    for t in telefonos:\n        # Intentar diferentes posibles nombres de columna\n        lugar = t.get('lugar') or t.get('Lugar') or t.get('nombrepunto') or t.get('Nombre')\n        if lugar and isinstance(lugar, str):\n            lugar = lugar.strip()",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_record_sale",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_record_sale():\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    # Validar producto - usando fieldnames específicos para productos\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:\n            product = p\n            break",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "events",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def events():\n    # Usar bazares.csv para eventos (con fechas)\n    bazares = load_csv('bazares.csv')\n    return render_template('events.html', bazares=bazares)\n@app.route('/api/save_comment_events', methods=['POST'])\ndef api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_save_comment_events",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_save_comment_events():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsventa_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "points",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def points():\n    # Usar puntosventa.csv para puntos de venta (sin fechas)\n    puntos = load_csv('puntosventa.csv')\n    return render_template('points.html', puntos=puntos)\n@app.route('/api/save_comment_points', methods=['POST'])\ndef api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_save_comment_points",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_save_comment_points():\n    comment = request.json.get('comment', '').strip()\n    if comment:\n        fecha = datetime.now().strftime('%Y-%m-%d')\n        filename = f\"commentsbazar_{fecha}.csv\"\n        filepath = os.path.join(COMMENTS_DIR, filename)\n        fieldnames = ['timestamp', 'comment']\n        file_exists = os.path.exists(filepath)\n        try:\n            with open(filepath, 'a', newline='', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "tutorials",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def tutorials():\n    tutoriales = load_csv('tutoriales.csv')\n    return render_template('tutorials.html', tutoriales=tutoriales)\n@app.route('/info')\ndef info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "info",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def info():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    telefonos = load_csv('telefonos.csv')\n    return render_template('info.html', telefonos=telefonos)\n# Nueva ruta para el dashboard\n@app.route('/dashboard')\ndef dashboard():\n    # Verificar acceso",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "dashboard",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def dashboard():\n    # Verificar acceso\n    if not session.get('authorized'):\n        return render_template('auth_required.html')\n    return render_template('dashboard.html')\n# API para datos del dashboard\n# @app.route('/api/dashboard_data')\n# def api_dashboard_data():\n#    if not session.get('authorized'):\n#        return jsonify({'error': 'No autorizado'}), 403",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_summary",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_sales_summary():\n    \"\"\"Resumen general de ventas del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    # Buscar archivos de ventas de hoy\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_top_products",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_top_products(limit=5):\n    \"\"\"Productos más vendidos del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    product_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n                    reader = csv.DictReader(file, delimiter=app_config.CSV_DELIMITER)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_by_location",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_sales_by_location():\n    \"\"\"Ventas por ubicación del día\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    location_sales = {}\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            total_amount = 0\n            total_sales = 0",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_recent_activity",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_recent_activity():\n    \"\"\"Actividad reciente (últimas 5 ventas)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    recent_sales = []\n    for filename in os.listdir(SALES_DIR):\n        if today in filename:\n            filepath = os.path.join(SALES_DIR, filename)\n            location = filename.replace(f'_{today}.csv', '')\n            try:\n                with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_performance_metrics",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_performance_metrics():\n    \"\"\"Métricas de rendimiento\"\"\"\n    today = datetime.now()\n    week_ago = today - timedelta(days=7)\n    # Esta es una implementación básica - se puede expandir\n    return {\n        'avg_daily_sales': 150000,  # Ejemplo - implementar cálculo real\n        'best_selling_category': 'Jeans',\n        'peak_hour': '16:00-17:00',\n        'conversion_rate': '68%'",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_authorize",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_authorize():\n    password = request.json.get('password', '')\n    # Usar contraseña de la configuración\n    if password == app_config.INFO_PASSWORD:\n        session['authorized'] = True\n        return jsonify({'success': True})\n    else:\n        return jsonify({'success': False, 'message': 'Contraseña incorrecta'})\n@app.route('/under_construction')\ndef under_construction():",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "under_construction",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def under_construction():\n    return render_template('under_construction.html')\n# =============================================================================\n# NUEVAS FUNCIONES PARA REPORTES AVANZADOS\n# =============================================================================\ndef get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_sales_data_by_date_range",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_sales_data_by_date_range(start_date, end_date):\n    \"\"\"Obtener datos de ventas para un rango de fechas específico\"\"\"\n    total_sales = 0\n    total_amount = 0\n    locations_active = set()\n    daily_data = {}\n    product_sales = {}\n    location_sales = {}\n    # Convertir fechas a objetos datetime si son strings\n    if isinstance(start_date, str):",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_period_data",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_period_data(period):\n    \"\"\"Obtener datos para períodos predefinidos\"\"\"\n    today = datetime.now().date()\n    if period == 'today':\n        start_date = today\n        end_date = today\n    elif period == 'week':\n        start_date = today - timedelta(days=today.weekday())\n        end_date = start_date + timedelta(days=6)\n    elif period == 'month':",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_reports",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_reports():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    period = request.args.get('period', 'today')\n    start_date = request.args.get('start_date')\n    end_date = request.args.get('end_date')\n    if start_date and end_date:\n        # Usar rango personalizado\n        data = get_sales_data_by_date_range(start_date, end_date)\n    else:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_dashboard_data",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_dashboard_data():\n    if not session.get('authorized'):\n        return jsonify({'error': 'No autorizado'}), 403\n    # Por defecto mostrar datos del día actual\n    data = get_period_data('today')\n    return jsonify(data)\ndef get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_all_daily_sales",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_all_daily_sales(lugar):\n    \"\"\"Obtener todas las ventas del día para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    sales_data = []\n    total_amount = 0\n    total_sales = 0\n    # Limpiar nombre del lugar para el archivo\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()\n    filename = f\"{lugar_limpio}_{today}.csv\"\n    filepath = os.path.join(SALES_DIR, filename)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_get_all_daily_sales",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_get_all_daily_sales(lugar):\n    \"\"\"API para obtener todas las ventas del día de un lugar específico\"\"\"\n    try:\n        daily_data = get_all_daily_sales(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_process_return",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_process_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_all_daily_transactions",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_all_daily_transactions(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones)\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_get_daily_transactions(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones)\"\"\"\n    try:\n        daily_data = get_all_daily_transactions(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_process_product_return",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_process_product_return():\n    \"\"\"Procesar devolución de producto\"\"\"\n    lugar = request.json.get('lugar')\n    codigo = request.json.get('codigo', '').strip().upper()\n    motivo = request.json.get('motivo', '').strip()\n    # Validar producto\n    productos = load_csv('productos.csv', fieldnames=['cod_fabrica', 'cod_venta', 'descripcion', 'precio'])\n    product = None\n    for p in productos:\n        if p.get('cod_fabrica') == codigo or p.get('cod_venta') == codigo:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def get_daily_transactions_with_returns(lugar):\n    \"\"\"Obtener todas las transacciones del día (ventas y devoluciones) para un lugar específico\"\"\"\n    today = datetime.now().strftime('%Y-%m-%d')\n    transactions = []\n    total_amount = 0\n    total_sales = 0\n    total_returns = 0\n    returns_amount = 0\n    # Cargar ventas del día\n    lugar_limpio = \"\".join(c for c in lugar if c.isalnum() or c in (' ', '-', '_')).rstrip()",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "api_get_daily_transactions_with_returns",
        "kind": 2,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "def api_get_daily_transactions_with_returns(lugar):\n    \"\"\"API para obtener todas las transacciones del día (ventas + devoluciones) de un lugar específico\"\"\"\n    try:\n        daily_data = get_daily_transactions_with_returns(lugar)\n        return jsonify({\n            'success': True,\n            'daily_data': daily_data\n        })\n    except Exception as e:\n        return jsonify({",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "app = Flask(__name__)\n# Cargar configuración\napp_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "app_config",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "app_config = get_config()\napp.config.from_object(app_config)\n# Configuración de directorios desde config\nDATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "DATA_DIR",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "DATA_DIR = app_config.DATA_DIR\nSALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "SALES_DIR",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "SALES_DIR = app_config.SALES_DIR\nCOMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "COMMENTS_DIR",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "COMMENTS_DIR = app_config.COMMENTS_DIR\nPHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "PHOTOS_DIR",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "PHOTOS_DIR = app_config.PHOTOS_DIR\nTUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "TUTORIALS_DIR",
        "kind": 5,
        "importPath": "app_ok",
        "description": "app_ok",
        "peekOfCode": "TUTORIALS_DIR = app_config.TUTORIALS_DIR\n# Asegurar que los directorios existan\nensure_directories(app_config)\ndef load_csv(filename, fieldnames=None):\n    \"\"\"Cargar archivo CSV con manejo de errores\"\"\"\n    filepath = os.path.join(DATA_DIR, filename)\n    data = []\n    try:\n        with open(filepath, 'r', encoding=app_config.CSV_ENCODING) as file:\n            # Detectar delimitador",
        "detail": "app_ok",
        "documentation": {}
    },
    {
        "label": "Config",
        "kind": 6,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "class Config:\n    # Clave secreta para sesiones y tokens\n    SECRET_KEY = os.environ.get('SECRET_KEY') or 'dev-key-cambiar-en-produccion-2024'\n    # Configuración de directorios\n    BASE_DIR = os.path.abspath(os.path.dirname(__file__))\n    DATA_DIR = os.path.join(BASE_DIR, 'data')\n    SALES_DIR = os.path.join(BASE_DIR, 'sales_data')\n    COMMENTS_DIR = os.path.join(BASE_DIR, 'comments')\n    PHOTOS_DIR = os.path.join(BASE_DIR, 'static', 'fotos')\n    TUTORIALS_DIR = os.path.join(BASE_DIR, 'static', 'tutoriales')",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DevelopmentConfig",
        "kind": 6,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "class DevelopmentConfig(Config):\n    DEBUG = True\n    TESTING = False\nclass ProductionConfig(Config):\n    DEBUG = False\n    TESTING = False\n    # En producción, usar variables de entorno\n    SECRET_KEY = os.environ.get('SECRET_KEY', 'production-secret-key-change-me')\n    INFO_PASSWORD = os.environ.get('INFO_PASSWORD', 'boa2024')\nclass TestingConfig(Config):",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ProductionConfig",
        "kind": 6,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "class ProductionConfig(Config):\n    DEBUG = False\n    TESTING = False\n    # En producción, usar variables de entorno\n    SECRET_KEY = os.environ.get('SECRET_KEY', 'production-secret-key-change-me')\n    INFO_PASSWORD = os.environ.get('INFO_PASSWORD', 'boa2024')\nclass TestingConfig(Config):\n    TESTING = True\n    DEBUG = True\n# Configuración por defecto",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TestingConfig",
        "kind": 6,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "class TestingConfig(Config):\n    TESTING = True\n    DEBUG = True\n# Configuración por defecto\nconfig = {\n    'development': DevelopmentConfig,\n    'production': ProductionConfig,\n    'testing': TestingConfig,\n    'default': DevelopmentConfig\n}",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "get_config",
        "kind": 2,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "def get_config():\n    \"\"\"Obtener configuración basada en entorno\"\"\"\n    env = os.environ.get('FLASK_ENV', 'development')\n    return config.get(env, config['default'])\n# Funciones de utilidad (sin dependencias de app.py)\ndef ensure_directories(config_obj):\n    \"\"\"Asegurar que todos los directorios necesarios existan\"\"\"\n    directories = [\n        config_obj.DATA_DIR,\n        config_obj.SALES_DIR,",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "ensure_directories",
        "kind": 2,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "def ensure_directories(config_obj):\n    \"\"\"Asegurar que todos los directorios necesarios existan\"\"\"\n    directories = [\n        config_obj.DATA_DIR,\n        config_obj.SALES_DIR,\n        config_obj.COMMENTS_DIR,\n        config_obj.PHOTOS_DIR,\n        config_obj.TUTORIALS_DIR\n    ]\n    for directory in directories:",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "allowed_file",
        "kind": 2,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "def allowed_file(filename, config_obj):\n    \"\"\"Verificar si la extensión del archivo está permitida\"\"\"\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in config_obj.ALLOWED_EXTENSIONS\ndef validate_sales_code(code, config_obj):\n    \"\"\"Validar formato de código de ventas\"\"\"\n    if not code.startswith(config_obj.SALES_CODE_PREFIX):\n        return False\n    if len(code) != config_obj.SALES_CODE_LENGTH:\n        return False",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_sales_code",
        "kind": 2,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "def validate_sales_code(code, config_obj):\n    \"\"\"Validar formato de código de ventas\"\"\"\n    if not code.startswith(config_obj.SALES_CODE_PREFIX):\n        return False\n    if len(code) != config_obj.SALES_CODE_LENGTH:\n        return False\n    # Verificar que los caracteres después de BI sean válidos\n    suffix = code[2:]\n    if not suffix[:4].isdigit():  # NNNN deben ser dígitos\n        return False",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "validate_factory_code",
        "kind": 2,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "def validate_factory_code(code, config_obj):\n    \"\"\"Validar formato de código de fábrica\"\"\"\n    return 3 <= len(code) <= 8 and code.isalnum()",
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "config",
        "kind": 5,
        "importPath": "config",
        "description": "config",
        "peekOfCode": "config = {\n    'development': DevelopmentConfig,\n    'production': ProductionConfig,\n    'testing': TestingConfig,\n    'default': DevelopmentConfig\n}\ndef get_config():\n    \"\"\"Obtener configuración basada en entorno\"\"\"\n    env = os.environ.get('FLASK_ENV', 'development')\n    return config.get(env, config['default'])",
        "detail": "config",
        "documentation": {}
    }
]